<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Cahier des Charges - Application de Réservations</title>
  <style>
    @page { margin: 2cm; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      color: #2563eb;
      border-bottom: 3px solid #2563eb;
      padding-bottom: 10px;
      margin-top: 30px;
    }
    h2 {
      color: #1e40af;
      margin-top: 25px;
      border-left: 4px solid #2563eb;
      padding-left: 15px;
    }
    h3 {
      color: #1e3a8a;
      margin-top: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
      background: white;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: left;
    }
    th {
      background-color: #2563eb;
      color: white;
      font-weight: bold;
    }
    tr:nth-child(even) {
      background-color: #f8fafc;
    }
    ul, ol {
      margin: 10px 0;
      padding-left: 30px;
    }
    li {
      margin: 5px 0;
    }
    .section {
      margin-bottom: 30px;
    }
    .code-block {
      background: #f1f5f9;
      border-left: 4px solid #2563eb;
      padding: 15px;
      margin: 15px 0;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
    }
    .highlight {
      background-color: #fef3c7;
      padding: 2px 5px;
      border-radius: 3px;
    }
    .header {
      text-align: center;
      margin-bottom: 40px;
      padding: 20px;
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
      color: white;
      border-radius: 8px;
    }
    .footer {
      margin-top: 50px;
      padding-top: 20px;
      border-top: 2px solid #e5e7eb;
      text-align: center;
      color: #6b7280;
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1 style="border: none; color: white; margin: 0;">CAHIER DES CHARGES PROFESSIONNEL</h1>
    <p style="margin: 10px 0 0 0; font-size: 1.2em;">Application Web de Gestion de Réservations</p>
  </div>

  <div class="section">
    <h2>1. Présentation du projet</h2>
    
    <h3>1.1 Contexte</h3>
    <p>Les petits salons, coachs indépendants et artisans gèrent souvent leurs rendez-vous de manière artisanale (agenda papier, SMS, téléphone, messageries diverses).</p>
    <p>Cette organisation entraîne :</p>
    <ul>
      <li>des erreurs de planning (surbooking, créneaux oubliés),</li>
      <li>une perte de temps dans les échanges,</li>
      <li>une image peu professionnelle,</li>
      <li>peu ou pas d'automatisation.</li>
    </ul>

    <h3>1.2 Objectif général</h3>
    <p>Développer une application web simple permettant :</p>
    <ul>
      <li>la publication en ligne de créneaux disponibles,</li>
      <li>la prise de rendez-vous via un lien public,</li>
      <li>l'enregistrement et la gestion centralisée des réservations,</li>
      <li>l'envoi automatisé d'e-mails de confirmation et d'annulation,</li>
      <li>une accessibilité pour des utilisateurs non techniques,</li>
      <li><span class="highlight">la configuration d'une semaine type lors de la création du compte,</span></li>
      <li><span class="highlight">l'intégration de la localisation via Google Maps.</span></li>
    </ul>

    <h3>1.3 Public cible</h3>
    <ul>
      <li>Petits salons et indépendants</li>
      <li>Coachs</li>
      <li>Artisans</li>
      <li>Micro-entrepreneurs</li>
    </ul>
  </div>

  <div class="section">
    <h2>2. Périmètre fonctionnel</h2>
    
    <h3>2.1 Acteurs</h3>
    <table>
      <thead>
        <tr>
          <th>Acteur</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Gérant (Utilisateur)</td>
          <td>Gère planning, prestations, réservations de son entreprise</td>
        </tr>
        <tr>
          <td>Client final (Utilisateur)</td>
          <td>Prend un rendez-vous via lien public</td>
        </tr>
        <tr>
          <td>Administrateur technique (optionnel)</td>
          <td>Paramétrage global du système</td>
        </tr>
      </tbody>
    </table>

    <h3>2.2 Fonctionnalités principales</h3>
    <ul>
      <li>Gestion de comptes utilisateurs (création, connexion, modification)</li>
      <li>Gestion des entreprises (création, modification, slug public)</li>
      <li><span class="highlight">Configuration de la semaine type avec créneaux récurrents</span></li>
      <li>Gestion des créneaux de réservation</li>
      <li>Gestion des prestations (types, durée, tarif optionnel)</li>
      <li>Prise de rendez-vous via lien public unique</li>
      <li>Emails automatiques de confirmation / annulation</li>
      <li>Gestion des réservations (filtrage, statut, historique)</li>
      <li><span class="highlight">Intégration Google Maps pour localisation des entreprises</span></li>
      <li>Rappels automatiques (optionnel)</li>
    </ul>
  </div>

  <div class="section">
    <h2>3. Scénarios d'usage</h2>
    
    <h3>Scénario 1 : Création d'un compte et configuration initiale</h3>
    <ol>
      <li>L'utilisateur crée son compte (nom, prénom, email, mot de passe, date de naissance, téléphone).</li>
      <li>Il crée son entreprise (nom entreprise, secteur, adresse complète).</li>
      <li><span class="highlight">Intégration Google Maps : saisie de l'adresse avec autocomplétion, récupération des coordonnées (latitude/longitude).</span></li>
      <li><span class="highlight">Configuration de la semaine type :</span>
        <ul>
          <li>Définition des horaires d'ouverture pour chaque jour de la semaine</li>
          <li>Choix de la durée des créneaux (30 min, 1h, etc.)</li>
          <li>Génération automatique des créneaux récurrents</li>
        </ul>
      </li>
      <li>Création des prestations disponibles.</li>
      <li>Accès au tableau de bord avec créneaux générés automatiquement.</li>
    </ol>

    <h3>Scénario 2 : Paramétrage du calendrier</h3>
    <ol>
      <li>Consultation du calendrier généré automatiquement à partir de la semaine type.</li>
      <li>Modification de la semaine type si nécessaire (changement permanent).</li>
      <li>Blocage de créneaux spécifiques (congés, événements ponctuels).</li>
      <li>Les créneaux se régénèrent automatiquement selon la semaine type.</li>
    </ol>

    <h3>Scénario 3 : Réservation par un client</h3>
    <ol>
      <li>Accès via lien public (slugPublic de l'entreprise).</li>
      <li><span class="highlight">Visualisation de l'adresse de l'entreprise avec carte Google Maps interactive.</span></li>
      <li>Consultation des créneaux disponibles.</li>
      <li>Sélection d'un créneau et d'une prestation.</li>
      <li>Saisie du formulaire (nom, prénom, date de naissance, email, téléphone optionnel, commentaire).</li>
      <li>Si le client est nouveau, création de son compte utilisateur.</li>
      <li>Validation et vérification serveur de la disponibilité.</li>
      <li>Enregistrement de la réservation et envoi e-mail de confirmation.</li>
    </ol>

    <h3>Scénario 4 : Annulation</h3>
    <ol>
      <li>Le gérant annule une réservation depuis son tableau de bord.</li>
      <li>Statut de la réservation mis à jour en base de données.</li>
      <li>Le créneau redevient disponible.</li>
      <li>Envoi automatique d'un e-mail d'annulation au client.</li>
    </ol>
  </div>

  <div class="section">
    <h2>4. Exigences non fonctionnelles</h2>
    
    <h3>4.1 UX & Accessibilité</h3>
    <ul>
      <li>Interface responsive (PC / tablette / smartphone)</li>
      <li>Navigation intuitive</li>
      <li>Formulaires avec validation client et serveur</li>
      <li><span class="highlight">Intégration fluide de Google Maps (autocomplétion, affichage carte)</span></li>
    </ul>

    <h3>4.2 Performance</h3>
    <ul>
      <li>Chargement du calendrier < 2 secondes en conditions normales</li>
      <li>Requêtes optimisées (indexation sur dates, clés étrangères)</li>
      <li><span class="highlight">Utilisation efficace de PostgreSQL</span></li>
    </ul>

    <h3>4.3 Sécurité</h3>
    <ul>
      <li>Hachage des mots de passe (bcrypt ou Argon2)</li>
      <li>Sessions sécurisées (JWT ou token + expiration)</li>
      <li>Validation stricte des données entrantes</li>
      <li>Isolation des données par entreprise</li>
      <li>Protection contre les injections SQL et XSS</li>
    </ul>

    <h3>4.4 RGPD</h3>
    <ul>
      <li>Suppression des données sur demande</li>
      <li>Anonymisation possible</li>
      <li>Mention légale de collecte des données</li>
      <li>Consentement explicite pour les communications</li>
    </ul>
  </div>

  <div class="section">
    <h2>5. Modèle de données (PostgreSQL)</h2>
    
    <h3>Tables principales</h3>
    <table>
      <thead>
        <tr>
          <th>Table</th>
          <th>Contenu</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Utilisateur</td>
          <td>Table centralisée pour gérants et clients (nom, prénom, email, credentials, date naissance, téléphone)</td>
        </tr>
        <tr>
          <td>Entreprise</td>
          <td>Informations entreprise, adresse complète, slug public, référence au gérant</td>
        </tr>
        <tr>
          <td>Prestation</td>
          <td>Types de prestations (libellé, durée, tarif)</td>
        </tr>
        <tr>
          <td>Creneau</td>
          <td>Créneaux horaires (date/heure début/fin, statut disponible)</td>
        </tr>
        <tr>
          <td>Reservation</td>
          <td>Réservations clients (référence entreprise, client, prestation, commentaire, statut, dates)</td>
        </tr>
        <tr>
          <td>LogEmail</td>
          <td>Suivi des envois / erreurs</td>
        </tr>
      </tbody>
    </table>

    <h3>Structure détaillée</h3>
    <div class="code-block">
      <strong>Utilisateur</strong>(idClient [PK], nom, prenom, dateNaissance, email [UNIQUE], motDePasseHash, telephone, dateInscription)<br><br>
      
      <strong>Entreprise</strong>(idPro [PK], nomEntreprise, nomSecteur, idGerant [FK→Utilisateur], slugPublic [UNIQUE], adresse, codePostal, ville, pays, <span class="highlight">latitude, longitude</span>)<br><br>
      
      <strong>Prestation</strong>(idPrestation [PK], idPro [FK→Entreprise], libelle, dureeMinutes, tarif)<br><br>
      
      <strong>Creneau</strong>(idCreneau [PK], idPro [FK→Entreprise], dateHeureDebut, dateHeureFin, statut)<br><br>
      
      <strong>Reservation</strong>(idReservation [PK], idPro [FK→Entreprise], idClient [FK→Utilisateur], idPrestation [FK→Prestation], commentaireClient, statut, dateCreation)<br><br>
      
      <strong>LogEmail</strong>(idLog [PK], idReservation [FK→Reservation], typeEmail, dateEnvoi, statutEnvoi)
    </div>

    <h3>Relations</h3>
    <ul>
      <li>Un Utilisateur (gérant) peut gérer une ou plusieurs Entreprises (1:N)</li>
      <li>Une Entreprise possède plusieurs Prestations (1:N)</li>
      <li>Une Entreprise possède plusieurs Créneaux (1:N)</li>
      <li>Un Utilisateur (client) peut faire plusieurs Réservations (1:N)</li>
      <li>Une Entreprise reçoit plusieurs Réservations (1:N)</li>
      <li>Une Prestation peut être réservée plusieurs fois (1:N)</li>
      <li>Une Réservation génère plusieurs LogEmail (1:N)</li>
    </ul>


  </div>

  <div class="section">
    <h2>6. Spécifications techniques</h2>
    
    <h3>6.1 Base de données</h3>
    <p><span class="highlight">PostgreSQL 14+</span> sera utilisé comme système de gestion de base de données relationnelle.</p>
    
    <h3>6.2 API externe</h3>
    <p><span class="highlight">Google Maps API</span> pour :</p>
    <ul>
      <li>Autocomplétion d'adresse (Places API)</li>
      <li>Récupération des coordonnées GPS (Geocoding API)</li>
      <li>Affichage de carte interactive sur la page publique (Maps JavaScript API)</li>
      <li>Nécessite une clé API (facturation possible selon usage)</li>
    </ul>

    <h3>6.3 Technologies</h3>
    <ul>
      <li><strong>Backend :</strong> Flask</li>
      <li><strong>ORM :</strong> SQLAlchemy</li>
      <li><strong>Frontend :</strong> React</li>
      <li><strong>Styling :</strong> Tailwind CSS</li>
    </ul>
  </div>

  <div class="section">
    <h2>7. Livrables attendus</h2>
    <table>
      <thead>
        <tr>
          <th>Livrable</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Application fonctionnelle</td>
          <td>Backend API REST + frontend responsive</td>
        </tr>
        <tr>
          <td>Base de données PostgreSQL</td>
          <td>Modèle relationnel complet avec migrations</td>
        </tr>
        <tr>
          <td>Documentation utilisateur</td>
          <td>Guide d'utilisation</td>
        </tr>
        <tr>
          <td>README technique</td>
          <td>Installation, configuration, lancement, variables d'environnement</td>
        </tr>
        <tr>
          <td>Jeu de données test</td>
          <td>Pour démonstration (seed data)</td>
        </tr>
        <tr>
          <td>Rapport de tests</td>
          <td>Fonctionnels et qualité</td>
        </tr>
        
      </tbody>
    </table>
  </div>

  <div class="section">
    <h2>8. Contraintes et risques</h2>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Élément</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Technique</td>
          <td><span class="highlight">Hébergement PostgreSQL (coût, limites selon provider)</span></td>
        </tr>
        <tr>
          <td>Sécurité</td>
          <td>Respect RGPD, protection données personnelles</td>
        </tr>
        <tr>
          <td><span class="highlight">API externe</span></td>
          <td>Dépendance à Google Maps (quota, coût potentiel)</td>
        </tr>
        <tr>
          <td>Planning</td>
          <td>Délais dépendants du besoin métier</td>
        </tr>
        <tr>
          <td>Risques</td>
          <td>Non-adoption si interface trop complexe</td>
        </tr>
        <tr>
          <td><span class="highlight">Performance</span></td>
          <td>Gestion de la récurrence des créneaux à grande échelle</td>
        </tr>
      </tbody>
    </table>
  </div>


  <div class="footer">
    <p>Document adapté le 29 novembre 2025</p>
  </div>
</body>
</html>